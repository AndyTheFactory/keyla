#summary Руководство по локализации программы

==== Интерфейс программы и информация о версии ====

===== Подготовка =====

Скачайте [http://keyla.googlecode.com/svn/trunk/keyla/res/resource.rc файл ресурсов]. Скопируйте секцию, соответствующую какому-либо языку, и вставьте её в конец файла. Например, если хотите создавать свой перевод на основе перевода на английский, скопируйте кусок, начиная с

`// === english resources ======================================================`

и кончая

`// === russian resources ======================================================`

(последнюю строчку включать не надо).
  
===== Указание языка =====

Измените комментарий в названии секции и название языка. Например, если переводите на украинский, вместо

`// === english resources ======================================================`

`LANGUAGE LANG_ENGLISH,SUBLANG_DEFAULT`

запишите

`// === ukrainian resources=====================================================`

`LANGUAGE LANG_UKRAINIAN,SUBLANG_DEFAULT`
  
===== Информация о версии =====

Информация о версии располагается под комментарием

`// ------- version info -------------------------------------------------------`
  
  * Найдите в разделе код вида
  
  `BLOCK "StringFileInfo"`
	
  `BEGIN`
	
  `BLOCK "040904b0"`
	
  и замените первые четыре цифры на код, соответствующий языку, на который переводите. Список кодов можно посмотреть на [http://msdn.microsoft.com/en-us/library/ms776294(VS.85).aspx странице MSDN]. Символы _0x_ надо отбросить.
	
  Если страница не найдена, воспользуйтесь [http://search.msdn.microsoft.com/ поиском] по ключевым словам "Language Identifier Constants and Strings" и лучше сообщите об этом нам.
	
  * Переведите все строки, кроме тех, что располагаются сразу после запятой после ключевых слов `BLOCK` и `VALUE`. Например, в строке
	
  `VALUE "FileDescription", "Keyboard layout switcher"`
	
  надо перести только строку `"Keyboard layout switcher"`
  
===== Диалоговые окна =====

Информация о диалоговых окнах располагается под комментарием

`// ------- dialogs ------------------------------------------------------------`

Каждому диалоговому окну соответствует участок кода вида

`... DIALOG ...`

`...`

`BEGIN`

`...`

`END`

Переводить требуется лишь строки, располагающиеся внутри блока, ограниченного ключевыми словами `BEGIN` и `END`, где перечисляются элементы управления, располагающиеся в окне. Начало и конец описания элемента управления легко определить по выравниванию строк. Описание элемента управления содержит ключевое слово и список параметров через запятую. Если первым параметром идёт строка, её надо перевести. Остальные строки трогать не надо.

===== Меню =====

Информация о меню располагается под комментарием

`// ------- menus --------------------------------------------------------------`

Каждому диалоговому окну соответствует участок кода вида

`... MENU`

`BEGIN`

`...`

`END`

Переводить требуется все строки, располагающиеся внутри блока, ограниченного ключевыми словами `BEGIN` и `END`.

===== Таблицы строк =====

Таблица строк располагается под комментарием

`// ------- string table -------------------------------------------------------`

Она описывается кодом вида

`STRINGTABLE`

`BEGIN`

`...`

`END`

Переводить требуется все строки, располагающиеся внутри блока, ограниченного ключевыми словами `BEGIN` и `END`.

==== Инсталлятор ====

===== Подготовка =====

Во-первых, скачайте [http://keyla.googlecode.com/svn-history/r34/trunk/NSIS%20installer/keyla.nsi скрипт NSIS]. Во-вторых, выберите файл локализованных строк из [http://code.google.com/p/keyla/source/browse/trunk/?r=34#trunk/NSIS%20installer/languages папки languages] с переводом, на который хотите опираться, создавая свой. Скачайте его, нажав на ссылку с названием файла, а затем - на ссылку с надписью "View raw file" в правой части страницы.

===== Добавление языка в инсталлятор =====

Инструкция добавления языка имеет вид

`!insertmacro MUI_LANGUAGE "<Язык>"`,

где <Язык> - английское название языка. Все инструкции собраны в список в скрипте NSIS. Их легко найти, используя поиск по `MUI_LANGUAGE`. Добавьте в конец списка инструкцию, соответствующую вашему языку. Например:

`!insertmacro MUI_LANGUAGE "Ukrainian"`

===== Включение файла локализованных строк =====

Вначале переименуйте скачанный файл локализованных строк по названию вашего языка. Например, файл для украинского языка должен называться "ukrainian.nsh".

Инструкции включения имеют вид

`!include "<путь-к-файлу>"`

Все они собраны в список в скрипте NSIS. Их легко найти, используя поиск по `english.nsh`. Добавьте в конец списка инструкцию для вашего файла локализованных строк. Например, 

`!include "languages\ukrainian.nsh"`

===== Информация о версии =====

Информация о версии располагается в скрипте NSIS под комментарием

`; Languages`

Элементы информации о версии добавляются с помощью инструкций `ViAddVersionKey`. Они сгруппированы по языку. Скопируйте любую группу в конец списка и измените её. 

Во-первых, поправьте в инструкциях константу вида `${LANG_ЯЗЫК}`. Например, если переводите на украинский, надо использовать `${LANG_UKRAINIAN}`.

Во-вторых, переведите инструкции. Если в инструкции указаны две строки, то переводить следует вторую. Другие строки переводить не надо.

===== Перевод файла локализованных строк =====

Следует аналогичным образом поменять константу `${LANG_ЯЗЫК}` и перевести все строки.

==== Отправка результатов ====

[http://code.google.com/p/keyla/issues/entry Напишите Issue] и вложите все файлы. Если у вас нет аккаунта Google, в порядке исключения можете отправить файлы мне по почте с темой "Keyla localization" (earshinov at gmail.com).

Можете сложить все файлы в архив, если вам так удобнее. Раскладывать файлы по папкам необязательно. 
